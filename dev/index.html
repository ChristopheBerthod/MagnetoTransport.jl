<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MagnetoTransport · MagnetoTransport</title><meta name="title" content="MagnetoTransport · MagnetoTransport"/><meta property="og:title" content="MagnetoTransport · MagnetoTransport"/><meta property="twitter:title" content="MagnetoTransport · MagnetoTransport"/><meta name="description" content="Documentation for MagnetoTransport."/><meta property="og:description" content="Documentation for MagnetoTransport."/><meta property="twitter:description" content="Documentation for MagnetoTransport."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">MagnetoTransport</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">MagnetoTransport</a><ul class="internal"><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Public-interface"><span>Public interface</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">MagnetoTransport</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">MagnetoTransport</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MagnetoTransport"><a class="docs-heading-anchor" href="#MagnetoTransport">MagnetoTransport</a><a id="MagnetoTransport-1"></a><a class="docs-heading-anchor-permalink" href="#MagnetoTransport" title="Permalink"></a></h1><p>The <a href="https://julialang.org">Julia</a> module <a href="index.html#MagnetoTransport">MagnetoTransport</a> addresses a problem in physics: computing the linear conductivity tensor of a two-dimensional gas of electrons in a perpendicular magnetic field, the electron scattering being described by an energy-dependent, yet momentum-independent self-energy.</p><h5 id="Definition-of-the-problem"><a class="docs-heading-anchor" href="#Definition-of-the-problem">Definition of the problem</a><a id="Definition-of-the-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Definition-of-the-problem" title="Permalink"></a></h5><p>This problem takes as inputs a dispersion relation <span>$E_{\mathbf{k}}$</span> for the noninteracting electrons, a complex self-energy function <span>$\Sigma(\varepsilon)$</span> describing the scattering at energy <span>$\varepsilon$</span>, a density <span>$n$</span> of electrons per surface unit, and a temperature <span>$T$</span>. The outputs are a chemical potential <span>$\mu$</span>, normal conductivities <span>$\sigma_{xx}$</span> and  <span>$\sigma_{yy}$</span>, and a Hall conductivity <span>$\sigma_{xy}$</span>. This problem is defined by the following set of coupled equations:</p><p class="math-container">\[\begin{align*}
(1)&amp;&amp;&amp;&amp;N_0(E)&amp;=2\int\frac{d^2k}{(2\pi)^2}\,\delta\left(E-E_{\mathbf{k}}\right)\\
(2)&amp;&amp;&amp;&amp;\Phi_{x,y}(E)&amp;=\left(\frac{e}{\hbar}\right)^22\int\frac{d^2k}{(2\pi)^2}
\left(\frac{\partial E_{\mathbf{k}}}{\partial k_{x,y}}\right)^2
\delta(E-E_{\mathbf{k}})\\
(3)&amp;&amp;&amp;&amp;\Phi_{xy}(E)&amp;=\left(\frac{|e|}{\hbar}\right)^3\frac{2\pi^2}{3}
\int\frac{d^2k}{(2\pi)^2}\left[2\frac{\partial E_{\mathbf{k}}}{\partial k_x}
\frac{\partial E_{\mathbf{k}}}{\partial k_y}
\frac{\partial^2E_{\mathbf{k}}}{\partial k_x\partial k_y}\right.\\
&amp;&amp;&amp;&amp;&amp;\hspace{11em}\left.-\left(\frac{\partial E_{\mathbf{k}}}{\partial k_x}\right)^2
\frac{\partial^2E_{\mathbf{k}}}{\partial k_y^2}
-\left(\frac{\partial E_{\mathbf{k}}}{\partial k_y}\right)^2
\frac{\partial^2E_{\mathbf{k}}}{\partial k_x^2}\right]\delta(E-E_{\mathbf{k}})\\
(4)&amp;&amp;&amp;&amp;A(E,\varepsilon)&amp;=\frac{-\mathrm{Im}\,\Sigma(\varepsilon)/\pi}
{[\varepsilon-E-\mathrm{Re}\,\Sigma(\varepsilon)]^2
+[\mathrm{Im}\,\Sigma(\varepsilon)]^2}\\
(5)&amp;&amp;&amp;&amp;N(\varepsilon)&amp;=\int_{-\infty}^{\infty}dE\,N_0(E)A(E,\varepsilon)\\
(6)&amp;&amp;&amp;&amp;n&amp;=\int_{-\infty}^{\infty}d\varepsilon\,\frac{N(\varepsilon)}
{\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}+1}\\
(7)&amp;&amp;&amp;&amp;\sigma_{xx,yy}&amp;=\pi\hbar\int_{-\infty}^{\infty}d\varepsilon\,
\frac{1}{k_{\mathrm{B}}T}\frac{\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}}
{[\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}+1]^2}
\int_{-\infty}^{\infty}dE\,\Phi_{x,y}(E)A^2(E,\varepsilon)\\
(8)&amp;&amp;&amp;&amp;\sigma_{xy}&amp;=B\hbar\int_{-\infty}^{\infty}d\varepsilon\,
\frac{1}{k_{\mathrm{B}}T}\frac{\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}}
{[\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}+1]^2}
\int_{-\infty}^{\infty}dE\,\Phi_{xy}(E)A^3(E,\varepsilon).
\end{align*}\]</p><p>In these equations, <span>$e$</span> is the <a href="https://en.wikipedia.org/wiki/Elementary_charge">elementary charge</a>, <span>$\hbar$</span> is the <a href="https://en.wikipedia.org/wiki/Planck_constant">reduced Planck constant</a>, <span>$k_{\mathrm{B}}$</span> is the <a href="https://en.wikipedia.org/wiki/Boltzmann_constant">Boltzmann constant</a>, <span>$\delta(\cdot)$</span> is the <a href="https://en.wikipedia.org/wiki/Dirac_delta_function">Dirac delta function</a>, and <span>$B$</span> is the magnetic field. Note that these equations require the dispersion relation <span>$E_{\mathbf{k}}$</span> to be twice differentiable and the function <span>$\Sigma(\varepsilon)$</span> to be <em>causal</em>, i.e., its real and imaginary parts must obey <a href="https://en.wikipedia.org/wiki/Kramers%E2%80%93Kronig_relations">Kramers-Kronig relations</a>.</p><h5 id="Formulation-in-terms-of-integral-transforms"><a class="docs-heading-anchor" href="#Formulation-in-terms-of-integral-transforms">Formulation in terms of integral transforms</a><a id="Formulation-in-terms-of-integral-transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Formulation-in-terms-of-integral-transforms" title="Permalink"></a></h5><p>The problem can be reformulated as</p><p class="math-container">\[\begin{align*}
(5&#39;)&amp;&amp;&amp;&amp;N(\varepsilon)&amp;=-\frac{1}{\pi}\,\mathrm{Im}\,(H\circ N_0)
\big(\varepsilon-\Sigma(\varepsilon)\big)\\
(6&#39;)&amp;&amp;&amp;&amp;n&amp;=\int_{-\infty}^0d\varepsilon\,N(\mu+\varepsilon)
+\int_0^{\infty}d\varepsilon\,\frac{1}
{\mathrm{e}^{\varepsilon/k_{\mathrm{B}}T}+1}
\left[N(\mu+\varepsilon)-N(\mu-\varepsilon)\right]\\
(7&#39;)&amp;&amp;&amp;&amp;\sigma_{xx,yy}&amp;=\frac{e^2}{h}2\pi^2\int_{-\infty}^{\infty}d\varepsilon\,
\frac{1}{k_{\mathrm{B}}T}\frac{\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}}
{[\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}+1]^2}
(L^2\circ\Phi_0^{x,y})\big(\varepsilon,\Sigma(\varepsilon)\big)\\
(8&#39;)&amp;&amp;&amp;&amp;\sigma_{xy}&amp;=B\frac{|e|^3}{h^2}4\pi^2
\int_{-\infty}^{\infty}d\varepsilon\,
\frac{1}{k_{\mathrm{B}}T}\frac{\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}}
{[\mathrm{e}^{(\varepsilon-\mu)/k_{\mathrm{B}}T}+1]^2}
(L^3\circ\Phi_1)\big(\varepsilon,\Sigma(\varepsilon)\big),
\end{align*}\]</p><p>where <span>$h=2\pi\hbar$</span> is the <a href="https://en.wikipedia.org/wiki/Planck_constant">Planck constant</a>. The complex function of a complex variable <span>$(H\circ N_0)(z)$</span> is the Hilbert transform of the function <span>$N_0(E)$</span>, which is defined as</p><p class="math-container">\[	(H\circ N_0)(z)=\int_{-\infty}^{\infty}dE\,\frac{N_0(E)}{z-E}\]</p><p>for <span>$z\in\mathbb{C}\setminus\mathbb{R}$</span>. The real functions <span>$(L^2\circ\Phi_0^{x,y})(r,z)$</span> and <span>$(L^3\circ\Phi_1)(r,z)$</span>  of one real variable <span>$r$</span> and one complex variable <span>$z$</span> are the order-2 and order-3 Lorentz transforms of the functions <span>$\Phi_0^{x,y}(E)=\Phi_{x,y}(E)/(e/\hbar)^2$</span> and <span>$\Phi_1(E)=\Phi_{xy}(E)/(|e|/\hbar)^3$</span>, which are defined as</p><p class="math-container">\[\begin{align*}
	(L^2\circ\Phi_0^{x,y})(r,z)=\int_{-\infty}^{\infty}dE\,
	\Phi_0^{x,y}(E)\left[\frac{-\mathrm{Im}\,z/\pi}
	{(r-\mathrm{Re}\,z-E)^2+(\mathrm{Im}\,z)^2}\right]^2\\
	(L^3\circ\Phi_1)(r,z)=\int_{-\infty}^{\infty}dE\,
	\Phi_1(E)\left[\frac{-\mathrm{Im}\,z/\pi}
	{(r-\mathrm{Re}\,z-E)^2+(\mathrm{Im}\,z)^2}\right]^3.
\end{align*}\]</p><p>In this formulation, the problem takes the four functions <span>$(H\circ N_0)$</span>, <span>$(L^2\circ\Phi_0^{x,y})$</span>, and <span>$(L^3\circ\Phi_1)$</span> as inputs, instead of the dispersion relation <span>$E_{\mathbf{k}}$</span>. These four functions only depend on <span>$E_{\mathbf{k}}$</span>, not on the other inputs <span>$\Sigma(\varepsilon)$</span>, <span>$n$</span>, and <span>$T$</span>.</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The <a href="https://julialang.org">Julia</a> modules <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/index.html#Piecewise">Piecewise</a>, <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert">PiecewiseHilbert</a>, and <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz">PiecewiseLorentz</a> provide tools for representing the functions <span>$N_0(E)$</span>, <span>$\Phi_0^{x,y}(E)$</span>, and <span>$\Phi_1(E)$</span> as <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/index.html#PiecewiseFunction"><code>PiecewiseFunction</code></a> objects and for constructing <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> and <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> objects holding their Hilbert and Lorentz transforms.</p><p>Inverting equation <span>$(6&#39;)$</span> to determine <span>$\mu$</span> is the most time-consuming part of the calculation. The first term in the right-hand side of equation <span>$(6&#39;)$</span> is the value of <span>$n$</span> at temperature <span>$T=0$</span>, while the second term is a correction only needed if <span>$T&gt;0$</span>. The method <a href="index.html#MagnetoTransport.number"><code>number</code></a> returns <span>$n$</span> for a given <span>$\mu$</span> and the method <a href="index.html#MagnetoTransport.chemical_potential"><code>chemical_potential</code></a> returns <span>$\mu$</span> for a given <span>$n$</span>. If an estimate of <span>$μ$</span> is available, it can be supplied using the optional keyword argument <code>μ0</code>. The method <a href="index.html#MagnetoTransport.σ₀"><code>σ₀</code></a> returns <span>$\sigma_{xx}$</span> or <span>$\sigma_{yy}$</span> divided by <span>$e^2/h$</span>, depending on which Lorentz transform is passed as the argument <code>L2oPhi0</code>. The method <a href="index.html#MagnetoTransport.σ₁"><code>σ₁</code></a> returns <span>$\sigma_{xy}/B$</span> divided by <span>$|e|^3/h^2$</span>. The method <a href="index.html#MagnetoTransport.RH"><code>RH</code></a> returns the Hall constant <span>$R_{\mathrm{H}}=\frac{\sigma_{xy}/B}{\sigma_{xx}\sigma_{yy}}$</span> divided by <span>$1/|e|$</span>. The methods <a href="index.html#MagnetoTransport.σ₀"><code>σ₀</code></a>, <a href="index.html#MagnetoTransport.σ₁"><code>σ₁</code></a>, and <a href="index.html#MagnetoTransport.RH"><code>RH</code></a> take either the density <span>$n$</span> as the first argument, in which case they use <a href="index.html#MagnetoTransport.chemical_potential"><code>chemical_potential</code></a> to determine <span>$\mu$</span>, or take the chemical potential <span>$\mu$</span> as the first argument.</p><p>Simplifications occur at <span>$T=0$</span>, since the integrals in equations <span>$(7&#39;)$</span> and <span>$(8&#39;)$</span> become trivial. The expressions <span>$(6&#39;)$</span>, <span>$(7&#39;)$</span>, and <span>$(8&#39;)$</span> are replaced at <span>$T=0$</span> by</p><p class="math-container">\[\begin{align*}
(6&#39;&#39;)&amp;&amp;&amp;&amp;n&amp;=\int_{-\infty}^0d\varepsilon\,N(\mu+\varepsilon)\\
(7&#39;&#39;)&amp;&amp;&amp;&amp;\sigma_{xx,yy}&amp;=\frac{e^2}{h}2\pi^2
(L^2\circ\Phi_0^{x,y})\big(\mu,\Sigma(\mu)\big)\\
(8&#39;&#39;)&amp;&amp;&amp;&amp;\sigma_{xy}/B&amp;=\frac{|e|^3}{h^2}4\pi^2
(L^3\circ\Phi_1)\big(\mu,\Sigma(\mu)\big).
\end{align*}\]</p><p>Hence, thanks to the use of Hilbert and Lorentz transforms, the numerical work at <span>$T=0$</span> is reduced to a single quadrature nested in a root-finding algorithm for solving equation <span>$(6&#39;&#39;)$</span>, while equations <span>$(7&#39;&#39;)$</span> and <span>$(8&#39;&#39;)$</span> are straight evaluations of mathematical functions. Additional quadratures are required if <span>$T&gt;0$</span> in equations <span>$(6&#39;)$</span>, <span>$(7&#39;)$</span> and <span>$(8&#39;)$</span>, but those are exponentially convergent at <span>$|\varepsilon|=\infty$</span>.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>The following example uses piecewise linear toy models for the functions <span>$N_0(E)$</span>, <span>$\Phi_0^{x,y}(E)$</span>, and <span>$\Phi_1(E)$</span>, that are not deduced from an underlying dispersion relation <span>$E_{\mathbf{k}}$</span>:</p><pre><code class="language-julia hljs">N₀ = PiecewiseFunction(:even, Piece((0, 1), POLY, [1]))
Φ₀ = PiecewiseFunction(:even, Piece((0, 1), POLY, [1, -1]))
Φ₁ = 2 * π^2 / 3 * PiecewiseFunction(:odd,
    [Piece((0, 0.5), POLY, [0, 1]), Piece((0.5, 1), POLY, [1, -1])])</code></pre><p><span>$N_0(E)$</span> has the shape of a rectangle: it equals one if <span>$-1&lt;E&lt;1$</span> and zero otherwise. <span>$\Phi_0^x(E)=\Phi_0^y(E)$</span> is an even function of <span>$E$</span> with the shape of a triangle, <span>$\Phi_1(E)$</span> is an odd function of <span>$E$</span> made of two triangles, and both of them vanish if <span>$|E|&gt;1$</span>. The following code draws these functions on a graph <code>p1</code>:</p><pre><code class="language-julia hljs">using Plots, LaTeXStrings, Measures
E = -2:0.001:2
p1 = plot(xlabel=L&quot;E&quot;, legend=:bottomright)
plot!(p1, E, N₀.(E), label=L&quot;N_0(E)&quot;)
plot!(p1, E, Φ₀.(E), label=L&quot;\Phi_0(E)&quot;)
plot!(p1, E, Φ₁.(E), label=L&quot;\Phi_1(E)&quot;)</code></pre><p>A causal self-energy may be deduced from a scattering rate <span>$\Gamma(E)$</span> according to</p><p class="math-container">\[	\Sigma(\varepsilon)=\int_{-\infty}^{\infty}dE\,
	\frac{\Gamma(E)}{\varepsilon-E+i0^+}
	=(H\circ\Gamma)(\varepsilon+i0^+).\]</p><p>This expression obeys Kramers-Kronig relations by construction. <span>$\Gamma(E)$</span> must be positive, such that <span>$\mathrm{Im}\,\Sigma(\varepsilon)=-\pi\Gamma(\varepsilon)$</span> is negative. A toy model is used here for <span>$\Gamma(E)$</span>, which is an even function of <span>$E$</span> vanishing as a square root at <span>$|E|=1.5$</span>. The following code defines <span>$\Sigma(\varepsilon)$</span> and draws it on a graph <code>p2</code>:</p><pre><code class="language-julia hljs">HoΓ = HilbertTransform(PiecewiseFunction(:even,
    Piece((0, 1.5), (true, false), PLS, [1.5, 0.5, 0.001])))
Σ(ε) = HoΓ(ε + im * eps(Float64))

p2 = plot(xlabel=L&quot;\varepsilon&quot;, legend=:topleft)
plot!(p2, E, real.(Σ.(E)), label=L&quot;\mathrm{Re}\,\Sigma(\varepsilon)&quot;)
plot!(p2, E, imag.(Σ.(E)), label=L&quot;\mathrm{Im}\,\Sigma(\varepsilon)&quot;)</code></pre><p>At this point, the interacting density of states <span>$N(\varepsilon)$</span> can be deduced according to equation <span>$(5&#39;)$</span>. The following code defines <span>$N(\varepsilon)$</span>, draws it on a graph <code>p3</code>, and displays the three graphs:</p><pre><code class="language-julia hljs">HoN₀ = HilbertTransform(N₀)
N(ε) = -imag(HoN₀(ε - Σ(ε))) / π

p3 = plot(xlabel=L&quot;\varepsilon&quot;, legend=:bottom)
plot!(p3, E, N.(E), label=L&quot;N(\varepsilon)&quot;)

plot(p1, p2, p3, layout=(1, 3), size = (1000, 300), margins=4mm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GKS: cannot open display - headless operation mode active</code></pre><p><img src="model.svg" alt/></p><p>The following code defines the <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> objects and then computes <span>$\mu$</span>, <span>$\sigma_{xx}$</span>, and <span>$\sigma_{xy}/B$</span> at <span>$T=0$</span> versus <span>$n\in[10^{-3},10^{-1}]$</span>. These data are put on the graphs <code>p1</code> and <code>p2</code>.</p><pre><code class="language-julia hljs">L²oΦ₀ = LorentzTransform(Φ₀, 2)
L³oΦ₁ = LorentzTransform(Φ₁, 3)

n = 10 .^ (-3:0.02:-1)
μ = chemical_potential.(n, 0, HoN₀, Σ)
σxx = σ₀.(μ, 0, L²oΦ₀, Σ)
σxy = σ₁.(μ, 0, L³oΦ₁, Σ)

p1 = plot(n, μ, label=L&quot;\mu(T=0)&quot;, xlabel=L&quot;n&quot;, xscale=:log10)
p2 = plot(xlabel=L&quot;n&quot;, xscale=:log10, yscale=:log10, legend=:bottomright)
plot!(p2, n,  σxx, label=L&quot;\sigma_{xx}(T=0)&quot;)
plot!(p2, n, -σxy, label=L&quot;-\sigma_{xy}(T=0)/B&quot;)</code></pre><p>Now the values of <span>$\sigma_{xx}$</span> and <span>$\sigma_{xy}/B$</span> can be used to deduce the Hall constant <span>$R_{\mathrm{H}}=\sigma_{xy}/B/\sigma_{xx}^2$</span>. Because the scattering is weak, <span>$R_{\mathrm{H}}$</span> approaches <span>$-1/(|e|n)$</span> at large <span>$n$</span>, but deviates at low <span>$n$</span>, where it varies nonmonotonously with increasing temperature.</p><pre><code class="language-julia hljs">p3 = plot(xlabel=L&quot;n&quot;, xscale=:log10, yscale=:log10)
plot!(p3, [3e-3, 1e-1], 1 ./ [3e-3, 1e-1], lw=1, label=L&quot;1/n&quot;)
plot!(p3, n, .- σxy ./ σxx .^2, label=L&quot;-R_\mathrm{H}(T=0)&quot;)
plot!(p3, n, .- RH.(n, 0.001, L²oΦ₀, L³oΦ₁, Σ, HoN₀, tol=1e-5),
    label=L&quot;-R_\mathrm{H}(T=10^{-3})&quot;)
plot!(p3, n, .- RH.(n, 0.01, L²oΦ₀, L³oΦ₁, Σ, HoN₀, tol=1e-5),
    label=L&quot;-R_\mathrm{H}(T=10^{-2})&quot;)

plot(p1, p2, p3, layout=(1, 3), size = (1000, 300), margins=4mm)</code></pre><p><img src="RH.svg" alt/></p><h2 id="Public-interface"><a class="docs-heading-anchor" href="#Public-interface">Public interface</a><a id="Public-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Public-interface" title="Permalink"></a></h2><h3 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h3><ul><li><a href="index.html#MagnetoTransport.RH"><code>MagnetoTransport.RH</code></a></li><li><a href="index.html#MagnetoTransport.chemical_potential"><code>MagnetoTransport.chemical_potential</code></a></li><li><a href="index.html#MagnetoTransport.number"><code>MagnetoTransport.number</code></a></li><li><a href="index.html#MagnetoTransport.σ₀"><code>MagnetoTransport.σ₀</code></a></li><li><a href="index.html#MagnetoTransport.σ₁"><code>MagnetoTransport.σ₁</code></a></li></ul><h3 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagnetoTransport.number" href="#MagnetoTransport.number"><code>MagnetoTransport.number</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">number(μ, T, HoN0, Σ [, tol])</code></pre><p>Particle number for chemical potential <code>μ</code> and temperature <code>T</code> (energy units). <code>HoN0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> object holding the Hilbert transform of the density of states. <code>Σ(::Real)</code> is a function giving the self-energy. <code>tol</code> sets the relative tolerance of the quadratures (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L2-L9">source</a></section><section><div><pre><code class="language-julia hljs">number(μ, T, HoN0 [, tol])</code></pre><p>Particle number for chemical potential <code>μ</code> and temperature <code>T</code> (energy units) in the noninteracting case (<span>$\Sigma(\varepsilon)=-i0^+$</span>). <code>HoN0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> object holding the Hilbert transform of the density of states. <code>tol</code> sets the relative tolerance of the quadratures (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L63-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagnetoTransport.chemical_potential" href="#MagnetoTransport.chemical_potential"><code>MagnetoTransport.chemical_potential</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">chemical_potential(n, T, HoN0, Σ [, μ0] [, tol])</code></pre><p>Chemical potential for density <code>n</code> and temperature <code>T</code> (energy units). <code>HoN0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> object holding the Hilbert transform of the density of states. <code>Σ(::Real)</code> is a function giving the self-energy. <code>μ0</code> is an optional initial estimate. <code>tol</code> sets the relative tolerance of the quadratures and root finding (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L76-L84">source</a></section><section><div><pre><code class="language-julia hljs">chemical_potential(n, T, HoN0 [, μ0] [, tol])</code></pre><p>Chemical potential for density <code>n</code> and temperature <code>T</code> (energy units) in the noninteracting case (<span>$\Sigma(\varepsilon)=-i0^+$</span>). <code>HoN0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> object holding the Hilbert transform of the density of states. <code>μ0</code> is an optional initial estimate. <code>tol</code> sets the relative tolerance of the quadratures and root finding (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L115-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagnetoTransport.σ₀" href="#MagnetoTransport.σ₀"><code>MagnetoTransport.σ₀</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">σ₀(n, T, L2oPhi0, Σ, HoN0 [, εmin] [, εmax] [, μ0] [, tol])</code></pre><p>Normal conductivity in units of <span>$e^2/h$</span> for density <code>n</code> and temperature <code>T</code> (energy units). <code>L2oPhi0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> object holding the <span>$L^2$</span> transform of the transport function divided by <span>$(e/\hbar)^2$</span>. <code>Σ(::Real)</code> is a function giving the self-energy. <code>HoN0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> object holding the Hilbert transform of the density of states. <code>εmin</code> and <code>εmax</code> are optional limits of integration at finite-<span>$T$</span> (default <code>-Inf</code> and <code>+Inf</code>). <code>μ0</code> is an optional initial estimate for the chemical potential. <code>tol</code> sets the relative tolerance of the quadratures and root finding (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L128-L140">source</a></section><section><div><pre><code class="language-julia hljs">σ₀(μ, T, L2oPhi0, Σ [, εmin] [, εmax] [, tol])</code></pre><p>Normal conductivity in units of <span>$e^2/h$</span> for chemical potential <code>μ</code> and temperature <code>T</code> (energy units). <code>L2oPhi0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> object holding the <span>$L^2$</span> transform of the transport function divided by <span>$(e/\hbar)^2$</span>. <code>Σ(::Real)</code> is a function giving the self-energy. <code>εmin</code> and <code>εmax</code> are optional limits of integration at finite-<span>$T$</span> (default <code>-Inf</code> and <code>+Inf</code>). <code>tol</code> sets the relative tolerance of the quadrature (default <code>1e-8</code>). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L165-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagnetoTransport.σ₁" href="#MagnetoTransport.σ₁"><code>MagnetoTransport.σ₁</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">σ₁(n, T, L3oPhi1, Σ, HoN0 [, εmin] [, εmax] [, μ0] [, tol])</code></pre><p>Hall conductivity divided by <span>$B|e|^3/h^2$</span> for density <code>n</code> and temperature <code>T</code> (energy units). <code>L3oPhi1</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> object holding the <span>$L^3$</span> transform of the transport function divided by <span>$(|e|/\hbar)^3$</span>. <code>Σ(::Real)</code> is a function giving the self-energy. <code>HoN0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> object holding the Hilbert transform of the density of states. <code>εmin</code> and <code>εmax</code> are optional limits of integration at finite-<span>$T$</span> (default <code>-Inf</code> and <code>+Inf</code>). <code>μ0</code> is an optional initial estimate for the chemical potential. <code>tol</code> sets the relative tolerance of the quadratures and root finding (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L198-L210">source</a></section><section><div><pre><code class="language-julia hljs">σ₁(μ, T, L3oPhi1, Σ [, εmin] [, εmax] [, tol])</code></pre><p>Hall conductivity divided by <span>$B|e|^3/h^2$</span> for chemical potential <code>μ</code> and temperature <code>T</code> (energy units). <code>L3oPhi1</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> object holding the <span>$L^3$</span> transform of the transport function divided by <span>$(|e|/\hbar)^3$</span>. <code>Σ(::Real)</code> is a function giving the self-energy. <code>εmin</code> and <code>εmax</code> are optional limits of integration at finite-<span>$T$</span> (default <code>-Inf</code> and <code>+Inf</code>). <code>tol</code> sets the relative tolerance of the quadrature (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L235-L244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MagnetoTransport.RH" href="#MagnetoTransport.RH"><code>MagnetoTransport.RH</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RH(n, T, L2oPhi01 [, L2oPhi02], L3oPhi1, Σ, HoN0 [, εmin] [, εmax] [, μ0] [, tol])</code></pre><p>Hall constant multiplied by <span>$|e|$</span> for density <code>n</code> and temperature <code>T</code> (energy units). <code>L2oPhi01</code>, <code>L2oPhi02</code>, and <code>L3oPhi1</code> are <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> objects holding the <span>$L^2$</span> and <span>$L^3$</span> transforms of the transport functions. <code>Σ(::Real)</code> is a function giving the self-energy. <code>HoN0</code> is a <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/hilbert.html#PiecewiseHilbert.HilbertTransform"><code>HilbertTransform</code></a> object holding the Hilbert transform of the density of states. <code>εmin</code> and <code>εmax</code> are optional limits of integration at finite-<span>$T$</span> (default <code>-Inf</code> and <code>+Inf</code>). <code>μ0</code> is an optional initial estimate for the chemical potential. <code>tol</code> sets the relative tolerance of the quadratures and root finding (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L268-L280">source</a></section><section><div><pre><code class="language-julia hljs">RH(μ, T, L2oPhi01 [, L2oPhi02], L3oPhi1, Σ [, εmin] [, εmax] [, tol])</code></pre><p>Hall constant multiplied by <span>$|e|$</span> for chemical potential <code>μ</code> and temperature <code>T</code> (energy units). <code>L2oPhi01</code>, <code>L2oPhi02</code>, and <code>L3oPhi1</code> are <a href="https://ChristopheBerthod.github.io/Piecewise.jl/dev/lorentz.html#PiecewiseLorentz.LorentzTransform"><code>LorentzTransform</code></a> objects holding the <span>$L^2$</span> and <span>$L^3$</span> transforms of the transport functions. <code>Σ(::Real)</code> is a function giving the self-energy. <code>εmin</code> and <code>εmax</code> are optional limits of integration at finite-<span>$T$</span> (default <code>-Inf</code> and <code>+Inf</code>). <code>tol</code> sets the relative tolerance of the quadratures (default <code>1e-8</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ChristopheBerthod/MagnetoTransport.jl/blob/2bc2538368899c4eb4a610d015b8b615c4c63af6/src/public-methods.jl#L301-L311">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 12 February 2025 13:16">Wednesday 12 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
